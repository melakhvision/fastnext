name: connect to remote ssh command
on:
  push:
    branches: [ "main" ]
jobs:

  build:
    name: Build
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Build and publish to AZURE CR
        # uses: appleboy/ssh-action@master
        # with:
        #   host: ${{ secrets.HOST }}
        #   username: ${{ secrets.USERNAME }}
        #   password: ${{ secrets.PASSWORD }}
        #   port: ${{ secrets.PORT }}
        #   script: |
        #     if [ -d "nicetomakeitwork" ]; then
        #     echo "nicetomakeitwork does exist."
        #     fi
        uses: azure/docker-login@v1
        with:
          login-server: nextjsthiane.azurecr.io
          username: ${{ secrets.REGISTRY_USERNAME }}
          password: ${{ secrets.REGISTRY_PASSWORD }}

      - run: |
          docker build . -t nextjsthiane.azurecr.io/nextjsthiane:latest
          docker push nextjsthiane.azurecr.io/nextjsthiane:latest

